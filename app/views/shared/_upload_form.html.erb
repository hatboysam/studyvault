<script>
	$(document).ready(function () {
		
		(function($) {
			$.fn.spin = function(opts, color) {
				var presets = {
					"tiny": { lines: 8, length: 2, width: 2, radius: 3 },
					"small": { lines: 8, length: 4, width: 3, radius: 5 },
					"large": { lines: 10, length: 8, width: 4, radius: 8 }
				};
				if (Spinner) {
					return this.each(function() {
						var $this = $(this),
						data = $this.data();
						
						if (data.spinner) {
							data.spinner.stop();
						delete data.spinner;
					}
					if (opts !== false) {
						if (typeof opts === "string") {
							if (opts in presets) {
								opts = presets[opts];
							} else {
								opts = {};
							}
							if (color) {
								opts.color = color;
							}
						}
						data.spinner = new Spinner($.extend({color: 	$this.css('color')}, opts)).spin(this);
					}
				});
			} else {
				throw "Spinner class not available.";
			}
		};
		})(jQuery);
		
		
		$("#upload_submit").click(
			function() {
				$("#forspinner").spin();
				$("#upload_linked").hide();
				$("#spintarget").hide();
			}
		);
	});
</script>

<script>
$(document).ready(function () {
	
	auto_course('#upload_temp_coursename');
	auto_professor('#upload_professor');
 
});
</script>

<%= form_for(@upload, :html => {:multipart => true, "data-validate" => "parsley"}) do |f| %>
	
	<%= f.error_messages %>
	<div class="row">
		<div class = "field span4">
			<%= f.label(:semester, "Semester*") %>
			<%= f.select(:semester, options_for_select([["Fall","Fall"],["Spring","Spring"],["Summer","Summer"],["Winter","Winter"]])) %>
		</div>
		<div class = "field span4">
			<%= f.label(:year, "Year*") %>
			<%= date_select :upload, :year, :start_year => 1980, :end_year => Time.now.year, :discard_month => true %>
		</div>
	</div>
	<div class="row">
		<div class = "field span4">
			<%= f.label(:temp_coursename, "Course Name* (ex: BIOL 202)") %>
			<%= f.text_field :temp_coursename,
				"data-trigger" => "change",
				"data-notblank" => "true" %>
		</div>
		<div class = "field span4">
			<%= f.label(:professor, "Professor*") %>
			<%= f.text_field :professor,
				"data-trigger" => "change",
				"data-notblank" => "true" %>
		</div>
	</div>

	<div class="row">
		<div class = "field span8">
			<%= f.label(:description, "File Description") %>
			<%= f.text_field :description, :class => "description input-large" %>
		</div>
	</div>
	
	<%= f.hidden_field(:stars, :value => '0' )%>
	<%= f.hidden_field(:ratings, :value => '0' )%>
	<%= f.hidden_field(:school_id, :value => current_user.school.id )%>
	
	<div class = "field upload">
		<div class = "uploadbutton">
			<%= f.file_field(:linked) %>
		</div>
	</div>
	
	<br />

	<div class="actions" id = "spintarget">
    	<%= f.submit "Upload File", :class => "btn btn-success" %>
  	</div>

	<div id = "forspinner">
	
	</div>
	
<% end %>
<p><b>Note:</b> * indicates required field </p>